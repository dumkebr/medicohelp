Enable full medical feature access for doctors AND medical students (interns).

Who gets full access:
- if req.user.role IN ['medico', 'estudante'] OR req.user.verified_crm === true:
  UNLOCK:
  1) Posologia completa (adulto/pediatria) c/ ajustes renais/hep√°ticos e limites m√°x.
  2) Calculadoras cl√≠nicas (Alvarado, CURB-65, Centor/McIsaac, Wells DVT/PE, PERC, CHA2DS2-VASc, qSOFA, etc.)
  3) Condutas e planos curtos (sem substituir protocolo local)
  4) Diferenciais, pedidos de exame e interpreta√ß√£o b√°sica de resultados
  5) Gera√ß√£o de anamnese/evolu√ß√£o conforme estilo do perfil (Tradicional/SOAP/Personalizado)
  6) Evid√™ncias Cl√≠nicas no modo explicativo (se SEARCH_PROVIDER configurado)

Keep restricted only for non-medical roles (leigos/an√¥nimos).

UI:
- Header chip quando desbloqueado: "Modo Profissional ativo"
- Banner discreto em respostas m√©dicas:
  ‚Ä¢ role='medico': "Suporte √† decis√£o cl√≠nica. Revise com julgamento m√©dico."
  ‚Ä¢ role='estudante': "Conte√∫do para pr√°tica supervisionada. N√£o prescrever sem preceptor."
- Menu ‚ÄúFerramentas‚Äù ao lado do chat:
  ‚Ä¢ Posologia ‚Ä¢ Calculadoras ‚Ä¢ Condutas ‚Ä¢ Exames ‚Ä¢ Diferenciais
- Toggle j√° existente: ü©∫ Modo Cl√≠nico (padr√£o) / üìò Modo Explicativo.
  - Em Explicativo, permitir uso de Evid√™ncias Cl√≠nicas (se habilitado).

Endpoints (JWT):
- POST /tools/posologia {principio_ativo, indicacao, idade_anos, peso_kg?, creatinina_clear_mlmin?, gravidez?, lactacao?, alergias?}
  -> retorna esquema(s), ajustes, alertas, refer√™ncia curta
- POST /tools/calculadora/:nome {variaveis:{}}
  -> score, faixa de risco, interpreta√ß√£o breve
- POST /tools/conduta {quadro,resumo?} -> plano objetivo (sem receita)
- POST /tools/exames/pedir {quadro} -> lista sugerida com justificativa curta
- POST /tools/diferenciais {quadro} -> top-5 com red flags

Guarda inteligente (apenas o m√≠nimo):
- Pediatria/neonatos: exigir peso/idade p/ drogas mg/kg ‚Üí se faltar, retornar ‚Äúdados insuficientes‚Äù.
- Gravidez/lacta√ß√£o: exibir alerta se droga contraindicada.
- Seda√ß√£o/opi√°ceos/doses > limite: exigir confirma√ß√£o (‚ÄúConfirmar uso profissional‚Äù) e cap por POSO_MAX_DOSE_MULTIPLIER.
- Zero dados do paciente em chamadas de pesquisa externa.

Audit & Rate-limit:
- Log em DB: {user_id, role, tool, payload_summary, timestamp, ok|fail}
- Limit por user: 60 req/h por ferramenta (chat streaming conta √† parte).
- Env flags:
  MED_FULL_UNLOCK=true
  EVIDENCE_ALLOWED_IN_EXPLANATORY=true
  POSO_MAX_DOSE_MULTIPLIER=1.2
  CALC_ENABLE=["alvarado","curb65","centor","wells_dvt","wells_pe","perc","chadsvasc","qsofa"]

Tests r√°pidos:
- Como 'medico':
  ‚Ä¢ posologia valaciclovir adulto com ClCr=25 ‚Üí ajuste renal aplicado
  ‚Ä¢ calculadora Alvarado ‚Üí score e faixa
  ‚Ä¢ conduta ‚Äúcistite n√£o complicada‚Äù ‚Üí plano curto
- Como 'estudante':
  ‚Ä¢ posologia pedi√°trica sem peso ‚Üí ‚Äúdados insuficientes‚Äù ou faixa; com peso ‚Üí OK
  ‚Ä¢ calculadoras OK; conduta exibida c/ banner de supervis√£o
- Como leigo: ferramentas bloqueadas
