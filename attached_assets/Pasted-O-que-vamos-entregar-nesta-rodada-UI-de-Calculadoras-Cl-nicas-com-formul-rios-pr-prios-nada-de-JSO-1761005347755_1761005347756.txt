O que vamos entregar nesta rodada

UI de Calculadoras Cl√≠nicas com formul√°rios pr√≥prios (nada de JSON!).

Engine com esquema declarativo (cada calculadora define: entradas ‚Üí c√°lculo ‚Üí faixas de interpreta√ß√£o).

Hist√≥rico local (√∫ltimas 20) + Copiar/Imprimir.

Calculadoras iniciais: CURB-65, Alvarado, Wells TVP, Wells TEP, CHA‚ÇÇDS‚ÇÇ-VASc, HAS-BLED, qSOFA, SIRS, GCS, IMC.

Obstetr√≠cia: Idade gestacional por DUM, por DPP, por USG pr√©via (com DPP e IG ‚Äúhoje‚Äù).

üß© PROMPT 1 ‚Äî Framework + calculadoras cl√≠nicas

Cole no Replit (na caixa do agent).

TITLE: Build Clinical Calculators module with friendly forms (no JSON inputs)

GOAL
Create a calculators module with:
- A selector list of calculators
- Per-calculator friendly form (labels, hints, validation)
- Result card with value + interpretation + references
- Actions: Copy result, Print (A4), Save last 20 (local history)
- Medical disclaimer banner (apoio √† decis√£o)

TECH / STRUCTURE
- Add /calculators route or tab
- Data-driven schema for calculators:
  {
    id: "curb65",
    name: "CURB-65 (Pneumonia)",
    inputs: [
      { key:"confusion", label:"Confus√£o", type:"boolean" },
      { key:"urea", label:"Ureia > 7 mmol/L (ou BUN > 20 mg/dL)", type:"boolean" },
      { key:"resp_rate", label:"FR ‚â• 30 irpm", type:"boolean" },
      { key:"bp", label:"PAS < 90 ou PAD ‚â§ 60", type:"boolean" },
      { key:"age65", label:"Idade ‚â• 65 anos", type:"boolean" }
    ],
    compute: (v) => { score = sum booleans; return {score}; },
    interpret: (s) => [
      {range:[0,1], text:"Risco baixo; considerar ambulatorial"},
      {range:[2,2], text:"Risco moderado; interna√ß√£o ou observa√ß√£o"},
      {range:[3,5], text:"Risco alto; avaliar UTI"}
    ],
    refs: ["Lim WS et al. Thorax 2003"]
  }

UI
- Left: dropdown/search calculators
- Right: dynamic form for selected calculator
- Submit -> result card: SCORE + interpretation text + refs
- Buttons: Copiar, Imprimir
- Save last 20 calculations to localStorage (date, calc name, key inputs, result)

CALCULATORS TO INCLUDE
1) CURB-65 (as above)
2) Alvarado (Apendicite)
   Inputs:
     dolor_migratoria(b), anorexia(b), nausea(b), dorFID(b), descompressao(b), febre(b), leucocitose(b), desviamento(b)
   Score: 10
   Interpret: 1-4 baixo; 5-6 compat√≠vel; 7-10 prov√°vel.
3) Wells TVP
   Inputs bistate + ‚Äúdiagn√≥stico alternativo t√£o prov√°vel quanto TVP?‚Äù (negativo vale -2).
   Interpret: ‚â•3 alta; 1-2 moderada; 0 baixa. (Vers√£o simples: improv√°vel <2, prov√°vel ‚â•2)
4) Wells TEP (vers√£o simplificada por pontos)
5) CHA2DS2-VASc
   Campos cl√°ssicos; output: 0,1,‚â•2 (homem/mulher) com risco anual (%)
6) HAS-BLED (risco sangramento)
7) qSOFA: FR‚â•22, PAS‚â§100, altera√ß√£o de consci√™ncia ‚Üí 0‚Äì3
8) SIRS: ‚â•2 crit√©rios
9) Glasgow Coma Scale (GCS): Ocular, Verbal, Motora ‚Üí 3‚Äì15 (com descri√ß√µes)
10) IMC: peso/altura, classificar adultos

VALIDATION
- Campos obrigat√≥rios
- Tooltips para crit√©rios
- Explicitar unidades (ex: BUN/ureia equival√™ncias)

UX
- Consist√™ncia com tema da app (verde)
- Disclaimer fixo: ‚ÄúFerramenta de apoio. N√£o substitui julgamento cl√≠nico.‚Äù

ACCEPTANCE
- CURB-65: marcar 3 itens -> interpreta√ß√£o de risco alto
- Alvarado: 7/10 => prov√°vel
- GCS 15 no default; variando inputs reflete corretamente
- Hist√≥rico lista e reabre c√°lculo

üë∂ PROMPT 2 ‚Äî Calculadoras obst√©tricas (IG por DUM/DPP/USG)

Cole em seguida.

TITLE: Add Obstetric Calculators (LMP, EDD, Prior Ultrasound)

ADD A NEW GROUP "Obstetr√≠cia" with 3 calculators:

1) Idade Gestacional por DUM (LMP)
Inputs:
  - lmp_date (date): "DUM (primeiro dia da √∫ltima menstrua√ß√£o)"
Compute:
  - today = local date
  - GA_days = today - lmp_date (in days)
  - GA_weeks = floor(GA_days/7), GA_rem = GA_days % 7
  - EDD = lmp_date + 280 days (40w)  [Regra de N√§egele]
Output:
  - IG hoje: X semanas + Y dias
  - DPP estimada (EDD)
  - Trimestre atual (1: <14w; 2: 14‚Äì27w6d; 3: ‚â•28w)
  - Observa√ß√µes: ‚ÄúDUM incerta ‚Üí considerar USG precoce p/ datar‚Äù
Refs: ACOG dating guidelines

2) Idade Gestacional por DPP (EDD)
Inputs:
  - edd (date): "Data Prov√°vel do Parto"
Compute:
  - lmp_est = edd - 280 days
  - GA_days = today - lmp_est
  - IG hoje (Xw + Yd) e DUM estimada
Output:
  - IG hoje, DUM estimada, DPP (inserida)
Note: warn if edd < today - 3w or > today + 43w (consist√™ncia)

3) Idade Gestacional por USG pr√©via
Inputs:
  - usg_date (date): data do exame
  - usg_ga_weeks (number)
  - usg_ga_days (number, 0‚Äì6)
Compute:
  - GA_usg_days_total = usg_ga_weeks*7 + usg_ga_days
  - Today_GA_days = (today - usg_date) + GA_usg_days_total
  - Today_GA_weeks = floor(Today_GA_days/7), rem = Today_GA_days % 7
  - EDD_by_usg = today + (280 - Today_GA_days)  // ou usg_date + (280 - GA_usg_days_total)
Output:
  - IG hoje (Xw+Yd), DPP estimada por USG, trimestre
Warnings:
  - If usg_date > today: error
  - If GA_usg_days_total > 294 or < 0: error
Refs: ACOG/WHO ultrasound dating recommendations

UI/UX
- Friendly forms (date pickers; inputs num√©ricos para semanas/dias)
- Result card com:
  ‚Ä¢ IG hoje (semanas + dias)
  ‚Ä¢ DPP calculada
  ‚Ä¢ Faixa de trimestre
  ‚Ä¢ Notas (ex: ‚ÄúSe DUM incerta, priorize USG do 1¬∫ trimestre para datar‚Äù)
- Bot√µes: Copiar, Imprimir
- Adicionar esses itens ao Hist√≥rico

ACCEPTANCE
- LMP 01/01/2025 com hoje=20/10/2025 ‚âà IG 41w  // (ajuste autom√°tico)
- EDD 10/11/2025 -> DUM ~ 03/02/2025; IG hoje coerente
- USG 15/06/2025 com IG 12w+4d -> hoje: mostrar IG e DPP consistentes

üìè F√≥rmulas/Detalhes (j√° embutidos nos prompts)

N√§egele: DPP = DUM + 280 dias

IG hoje por DUM: IG_dias = hoje ‚àí DUM ‚Üí em semanas+dias

IG hoje por DPP: DUM_estimada = DPP ‚àí 280 ‚Üí IG como acima

IG por USG pr√©via:

IG_dias_hoje = (hoje ‚àí data_USG) + IG_USG_dias

DPP_USG = data_USG + (280 ‚àí IG_USG_dias) (equivalente partindo de ‚Äúhoje‚Äù)

Trimestres: 1T <14s; 2T 14‚Äì27s6d; 3T ‚â•28s.